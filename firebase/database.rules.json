{
    "rules": {
        "rooms": {
            "$roomId": {
                // Deck is SERVER ONLY - no client can read raw card values
                "deck": {
                    ".read": false,
                    ".write": false
                },
                // Game state is readable by authenticated users in the room
                "gameState": {
                    ".read": "auth != null && root.child('rooms').child($roomId).child('players').child(auth.uid).exists()",
                    ".write": "auth != null && root.child('rooms').child($roomId).child('players').child(auth.uid).exists()"
                },
                // Players info - public read, own data write
                "players": {
                    "$playerId": {
                        ".read": "auth != null && root.child('rooms').child($roomId).child('players').child(auth.uid).exists()",
                        // Only own data writable by player or by any player during game actions (for swaps)
                        ".write": "auth != null && (auth.uid == $playerId || root.child('rooms').child($roomId).child('players').child(auth.uid).exists())"
                    }
                },
                // Discard pile - public read/write for game actions
                "discardPile": {
                    ".read": "auth != null && root.child('rooms').child($roomId).child('players').child(auth.uid).exists()",
                    ".write": "auth != null && root.child('rooms').child($roomId).child('players').child(auth.uid).exists()"
                },
                // Private data - ONLY readable by owner
                "private": {
                    "$playerId": {
                        ".read": "auth != null && auth.uid == $playerId",
                        ".write": "auth != null && root.child('rooms').child($roomId).child('players').child(auth.uid).exists()"
                    }
                }
            }
        }
    }
}